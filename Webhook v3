--========================--
--   DISCORD WEBHOOK LOG  --
--========================--

local WEBHOOK_URL = "https://discord.com/api/webhooks/1451979120593342589/FNYUawc2lZWcimxgkNuCZ3xW-QOOpulLe-pptTuIFj21hiARDMXkS4Sg0t3_qsql-dWH" -- GANTI

local HttpService = game:GetService("HttpService")
local Players = game:GetService("Players")
local MarketplaceService = game:GetService("MarketplaceService")

-- LocalPlayer
local plr = Players.LocalPlayer
if not plr then
    pcall(function()
        plr = Players:WaitForChild("LocalPlayer", 5)
    end)
end

-- Player info
local playerName, displayName, playerId = "Unknown", "Unknown", 0
if plr then
    pcall(function()
        playerName = plr.Name
        displayName = plr.DisplayName
        playerId = plr.UserId
    end)
end

-- JobId
local jobId = game.JobId ~= "" and game.JobId or "Unknown"

-- Detect executor
local function detect_executor()
    if type(identifyexecutor) == "function" then
        local ok, res = pcall(identifyexecutor)
        if ok and res then return tostring(res) end
    end
    if syn and syn.request then return "Synapse X" end
    if KRNL_LOADED then return "Krnl" end
    if fluxus and fluxus.request then return "Fluxus" end
    if is_sirhurt_closure then return "SirHurt" end
    if exploit and exploit.request then return "UnknownExploit" end
    return "Unknown"
end

local executorName = detect_executor()

-- Game name
local placeName = "Unknown"
pcall(function()
    local info = MarketplaceService:GetProductInfo(game.PlaceId)
    if info and info.Name then
        placeName = info.Name
    end
end)

-- Roblox profile thumbnail
local thumbnailUrl = ""
pcall(function()
    local thumb, ready = Players:GetUserThumbnailAsync(
        playerId,
        Enum.ThumbnailType.HeadShot,
        Enum.ThumbnailSize.Size420x420
    )
    if ready then
        thumbnailUrl = thumb
    end
end)

-- Embed
local embed = {
    author = {
        name = "Script Execution Logger",
        icon_url = "https://i.imgur.com/7GZ6F6K.png"
    },
    title = "üöÄ Script Executed Successfully",
    description = "```Script berhasil dijalankan```",
    color = 0x5865F2,

    thumbnail = {
        url = thumbnailUrl ~= "" and thumbnailUrl or nil
    },

    fields = {
        { name = "üë§ Player", value = "```"..playerName.."```", inline = true },
        { name = "‚ú® Display Name", value = "```"..displayName.."```", inline = true },
        { name = "üÜî User ID", value = "```"..playerId.."```", inline = true },

        { name = "üõ† Executor", value = "```"..executorName.."```", inline = true },
        { name = "üéÆ Place ID", value = "```"..game.PlaceId.."```", inline = true },

        { name = "üìå Game Name", value = "```"..placeName.."```", inline = false },
        { name = "üåê Job ID", value = "```"..jobId.."```", inline = false },
    },

    footer = {
        text = "HDragons Logger ‚Ä¢ Roblox",
    },

    timestamp = os.date("!%Y-%m-%dT%H:%M:%SZ")
}

local payload = HttpService:JSONEncode({
    embeds = { embed }
})

-- Request wrapper (support banyak executor)
local function send(req)
    if syn and syn.request then return syn.request(req) end
    if http_request then return http_request(req) end
    if request then return request(req) end
    if fluxus and fluxus.request then return fluxus.request(req) end
end

local success, err = pcall(function()
    send({
        Url = WEBHOOK_URL,
        Method = "POST",
        Headers = {
            ["Content-Type"] = "application/json"
        },
        Body = payload
    })
end)

if success then
    print("Webhook terkirim | Executor:", executorName)
else
    warn("Webhook gagal:", err)
end

--========== END =========--
